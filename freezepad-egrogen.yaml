units:
  # Proxy Spacing Variables
  kx: cx
  ky: cy
  # Padding Variables
  px: kx + 2
  py: ky + 2

points:
  zones:
    matrix:
      anchor:
        shift: [0, 0]  # Centers a 4-column, 5-row matrix
      key:
        padding: 1ky
        spread: 1kx
      columns:
        col1:
          rows:
            row1: {name: matrix_col1_row1}
            row2: {name: matrix_col1_row2}
            row3: {name: matrix_col1_row3}
            row4: {name: matrix_col1_row4}
            row5: {name: matrix_col1_row5}
        col2:
          rows:
            row1: {name: matrix_col2_row1}
            row2: {name: matrix_col2_row2}
            row3: {name: matrix_col2_row3}
            row4: {name: matrix_col2_row4}
            row5: {name: matrix_col2_row5}
        col3:
          rows:
            row1: {name: matrix_col3_row1}
            row2: {name: matrix_col3_row2}
            row3: {name: matrix_col3_row3}
            row4: {name: matrix_col3_row4}
            row5: {name: matrix_col3_row5}
        col4:
          rows:
            row1: {name: matrix_col4_row1}
            row2: {name: matrix_col4_row2}
            row3: {name: matrix_col4_row3}
            row4: {name: matrix_col4_row4}
            row5: {name: matrix_col4_row5}
      rows:
        row1:
        row2:
        row3:
        row4:
        row5:

outlines:
  raw:
    - what: rectangle
      where: true
      size: [kx, ky]
  keys:
    - what: rectangle
      where: true
      size: [kx-0.5,ky-0.5]
  
  # SIMPLIFIED BOARD OUTLINE
  board:
    - what: rectangle
      where: true
      size: [px, py]
      fillet: 2

  # Preview combo for the outline view
  combo:
    - name: board
    - operation: subtract
      name: keys

pcbs:
  freezepad-pcb:
    template: kicad8
    outlines:
      main:
        outline: board
    footprints:
      # 1. SWITCHES (Direct Pin / No Diodes)
      choc_hotswap:
        what: choc
        where: true
        adjust:
          rotate: 180
        params:
            from: "{{name}}"
            to: GND
            keycaps: true
            reverse: false
            hotswap: true

      # 2. CONTROLLER (Nice!Nano)
      controller:
        what: nicenano
        where:
          ref: matrix_col2_row2
          shift: [1.325cx, 2.7cx]
          rotate: 180
        params:
          side: B
          orientation: up
          # Pin mapping - Left side of Controller (Top -> Down)
          P0: matrix_col1_row1
          P1: matrix_col1_row2
          P2: matrix_col1_row3
          P3: matrix_col1_row4
          P4: matrix_col1_row5
          
          # Left side continued
          P5: matrix_col2_row1
          P6: matrix_col2_row2
          P7: matrix_col2_row3
          P8: matrix_col2_row4
          P9: matrix_col2_row5
          
          # Right side top
          P10: matrix_col3_row1
          P14: matrix_col3_row2
          P15: matrix_col3_row3
          P16: matrix_col3_row4
          P18: matrix_col3_row5
          
          # Right side continued
          P19: matrix_col4_row1
          P20: matrix_col4_row2
          P21: matrix_col4_row3
          P31: matrix_col4_row4
          P32: matrix_col4_row5
          
      # 3. BATTERY CONNECTOR (JST)
      battery:
        what: ceoloide/battery_connector_jst_ph_2
        where:
          ref: matrix_col2_row2
          shift: [-0.3px, 2.95py]
          rotate: -90

        params:
          side: B

      # 4. POWER SWITCH (Slider)
      power_switch:
        what: slider
        where:
          ref: matrix_col2_row2
          shift: [0.1px, 3.08py]
        params:
          side: B
          from: B+
          to: RAW

      # 5. RESET BUTTON
      reset:
        what: button
        where:
          ref: matrix_col2_row2
          shift: [2.02px, 1.98py]
          rotate: 180
        params:
          side: B
          from: GND
          to: RST